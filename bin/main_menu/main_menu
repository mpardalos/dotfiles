#!/bin/env python
from pathlib import Path
from subprocess import run
import re

from rofi import Rofi
from rofi_menu import menu

menu_dir = Path.home()/'.bin/main_menu'
dot_bin  = Path.home()/'.bin'
r = Rofi(rofi_args=['-i'])

menu_items = {
    'Launcher': lambda: run([dot_bin/'launcher']),
    'Run': lambda: run(['rofi', '-modi', 'run', '-show', 'run']),
    'Edit dotfiles':
        lambda: run(['code', Path.home()/'.config/dotfiles']),
    'Reload config':
        lambda: run([Path.home()/'.config/bspwm/bspwmrc']),
}
namematcher = re.compile(r'(.+)\.menu')
for menu_file in menu_dir.iterdir():
    name_match = namematcher.match(menu_file.name)
    if name_match is not None:
        menu_items[name_match[1]] = lambda target=menu_file: run([target])


menu(r, 'Search', menu_items)
