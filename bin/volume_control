#!/bin/sh

# Script modified from these wonderful people:
# https://github.com/dastorm/volume-notification-dunst/blob/master/volume.sh
# https://gist.github.com/sebastiencs/5d7227f388d93374cebdf72e783fbd6a

notification_id=2500

usage() {
    echo "Usage: $(basename $0) [up|down|mute]"
}

is_mute() {
    return pamixer --get-mute | grep false
}
unmute()      pamixer --unmute
toggle_mute() pamixer --toggle-mute

get_volume()  pamixer --get-volume
volume_up()   pamixer --allow-boost --increase $1
volume_down() pamixer --allow-boost --decrease $1

send_notification() {
    iconSound="audio-volume-high-symbolic.symbolic"
    iconMuted="audio-volume-muted-symbolic.symbolic"
    if is_mute; then
        dunstify \
            --icon $iconMuted \
            --replace $notification_id \
            --urgency low \
            "mute"
    else
        volume=$(get_volume)
        bar=$(~/.bin/draw_bar 20 --percentage $volume)

        dunstify \
            --icon=$iconSound \
            --replace=$notification_id \
            --urgency=low \
            "$bar"
    fi
}

case $1 in
    up) volume_up 5 ;;
    down) volume_down 5 ;;
    mute) toggle_mute ;;
    *)
        usage
        exit 1
        ;;
esac

send_notification
